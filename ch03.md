## 문제 p3.1: 스프링-질량-댐퍼 시스템의 상태 공간 모델
스프링-질량-댐퍼 시스템의 상태 공간 모델을 구합니다.  
상태 변수를 x1 = y(위치), x2 = y_dot(속도)로 정의합니다.

```matlab
% 문제 p3.1: 스프링-질량-댐퍼 시스템의 상태 공간 모델
disp('==================== 문제 p3.1 ====================');
disp('스프링-질량-댐퍼 시스템의 상태 공간 모델을 구합니다.');
syms M b k
disp('(a) 상태 변수를 x1 = y(위치), x2 = y_dot(속도) 로 정의합니다.');
A = [0 1; -k/M -b/M];
B = [0; 1/M];
C = [1 0];
D = 0;
disp('(b), (c) 상태 공간 행렬 A, B, C, D 는 다음과 같습니다:');
fprintf('\nA 행렬 (Symbolic):\n'); pretty(A);
fprintf('\nB 행렬 (Symbolic):\n'); pretty(B);
fprintf('\nC 행렬 (Numeric):\n'); disp(C);
fprintf('\nD 행렬 (Numeric):\n'); disp(D);
```

출력  
```text
==================== 문제 p3.1 ====================
스프링-질량-댐퍼 시스템의 상태 공간 모델을 구합니다.
(a) 상태 변수를 x1 = y(위치), x2 = y_dot(속도) 로 정의합니다.
(b), (c) 상태 공간 행렬 A, B, C, D 는 다음과 같습니다:

A 행렬 (Symbolic):
[  0,    1]
[-k/M, -b/M]

B 행렬 (Symbolic):
[   0]
[1/M]

C 행렬 (Numeric):
     1     0

D 행렬 (Numeric):
     0
```

간단 해석
- 시스템 행렬 A는 [0 1; -k/M -b/M] 이므로 고유치(루트)는 s = (-b ± sqrt(b^2 - 4 k M))/(2 M).
- 감쇠 계수 b > 0 이고 스프링 상수 k > 0 이면 실수부가 음수로 되어 안정(정상 감쇠 혹은 과감쇠/저감쇠) 가능. b 작거나 음수면 불안정 가능.
- 즉 파라미터에 따라 안정성 달라짐.

---

## 문제 p3.3: RLC 회로의 상태 공간 모델
상태 변수: x1 = iL (인덕터 전류), x2 = vC (커패시터 전압)

```matlab
% 문제 p3.3: RLC 회로의 상태 공간 모델
disp('==================== 문제 p3.3 ====================');
disp('RLC 회로의 상태 미분 방정식을 구합니다.');
syms L C R
disp('상태 변수: x1 = iL (인덕터 전류), x2 = vC (커패시터 전압)');
A_p3_3 = [0, -1/L; 1/C, -1/(R*C)];
B_p3_3 = [1/L, -1/L; 0, 0];

disp('상태 공간 행렬 A, B 는 다음과 같습니다:');
fprintf('\nA 행렬:\n'); pretty(A_p3_3);
fprintf('\nB 행렬 (입력 u=[v1; v2]):\n'); pretty(B_p3_3);
```

출력
```text
==================== 문제 p3.3 ====================
RLC 회로의 상태 미분 방정식을 구합니다.
상태 변수: x1 = iL (인덕터 전류), x2 = vC (커패시터 전압)
상태 공간 행렬 A, B 는 다음과 같습니다:

A 행렬:
[   0,      -1/L]
[ 1/C, -1/(R*C)]

B 행렬 (입력 u=[v1; v2]):
[ 1/L, -1/L]
[   0,    0 ]
```

간단 해석
- 특성방정식은 s^2 + (1/(R C)) s + 1/(L C) = 0 형태(적절한 피드백/입력 구성에 따라).
- R > 0 이면 감쇠 항이 양수이므로 안정적일 가능성이 높음. R = 0 이면 무감쇠 및 진동. R < 0 은 불안정.
- 정확한 고유치는 L, C, R 값으로 결정됨.

---

## 문제 p3.5
주어진 전달 함수로부터 상태 공간 모델과 상태 천이 행렬을 구합니다.

```matlab
% 문제 p3.5
disp('==================== 문제 p3.5 ====================');
disp('주어진 전달 함수로부터 상태 공간 모델과 상태 천이 행렬을 구합니다.');
s = tf('s');
T = feedback((s+2)/((s+8)*(s-3)), 1); % G/(1+G*H)
% 2. 전달 함수 계수를 이용해 Phase Variable Form 행렬 바로 생성
den = T.Denominator{1}; % 분모 계수: [1 6 -22]
num = T.Numerator{1};   % 분자 계수: [1 2]

A = [0 1; -den(3) -den(2)];  % A = [0 1; -a0 -a1]
B = [0; 1];
C = [num(2) num(1)];        % C = [b0 b1]
D = 0;

% 3. 결과 출력
disp('Phase Variable Form 상태 공간 모델:');
fprintf('\nA 행렬:\n'); disp(A);
fprintf('B 행렬:\n'); disp(B);
fprintf('C 행렬:\n'); disp(C);
fprintf('D 행렬:\n'); disp(D);
```

출력
```text
==================== 문제 p3.5 ====================
주어진 전달 함수로부터 상태 공간 모델과 상태 천이 행렬을 구합니다.
Phase Variable Form 상태 공간 모델:

A 행렬:
     0     1
    22    -6

B 행렬:
     0
     1

C 행렬:
     2     1

D 행렬:
     0
```

간단 해석
- 닫힌 루프 전달함수 분모는 s^2 + 6 s - 22. 두 극의 해는 s = -3 ± sqrt(31) ≈ -3 ± 5.567.
- 따라서 한 극은 약 2.567 (양수), 다른 극은 약 -8.567 (음수). 양수 극이 있으므로 시스템은 불안정.
- 결론: 이 피드백 구성에서는 불안정.

---

## 문제 p3.12: 전달 함수로부터 상태 공간 모델과 상태 천이 행렬 구하기
주어진 전달 함수로부터 상태 공간 모델과 상태 천이 행이 행렬을 구합니다. 여기서는 Phi(t)를 완전한 심볼릭 닫힌형으로 전개합니다.

```matlab
% 문제 p3.12: 전달 함수로부터 상태 공간 모델과 상태 천이 행렬 구하기
disp('==================== 문제 p3.12 ====================');
disp('주어진 전달 함수로부터 상태 공간 모델과 상태 천이 행렬을 구합니다.');
num = [0 0 8 40];
den = [1 12 44 48];
[A, B, C, D] = tf2ss(num, den);
disp('(a) 상태 공간 모델(Controllable Canonical Form)은 다음과 같습니다:');
fprintf('\nA 행렬:\n'); disp(A);
fprintf('B 행렬:\n'); disp(B);
fprintf('C 행렬:\n'); disp(C);
fprintf('D 행렬:\n'); disp(D);
syms s t
I = eye(size(A));
Phi_s = inv(s*I - A);
Phi_t = ilaplace(Phi_s, t);
fprintf('\n(b) 상태 천이 행렬 Phi(t)는 다음과 같습니다:\n');
pretty(Phi_t);
```

출력
```text
==================== 문제 p3.12 ====================
주어진 전달 함수로부터 상태 공간 모델과 상태 천이 행렬을 구합니다.
(a) 상태 공간 모델(Controllable Canonical Form)은 다음과 같습니다:

A 행렬:
     0     1     0
     0     0     1
   -48   -44   -12

B 행렬:
     0
     0
     1

C 행렬:
    40     8     0

D 행렬:
     0
```

상태 천이 행렬 Phi(t) 완전 전개 (닫힌형)
- 특성다항식: s^3 + 12 s^2 + 44 s + 48 = 0 는 인수분해되어 (s + 2)(s + 4)(s + 6) 이므로 고유값은 λ1 = -2, λ2 = -4, λ3 = -6 입니다.
- 고유벡터는 각각
  - v1 = [1, -2, 4]^T  (for λ = -2)
  - v2 = [1, -4, 16]^T (for λ = -4)
  - v3 = [1, -6, 36]^T (for λ = -6)
- modal 분해를 사용하여 Phi(t) = P * diag(e^{λ_i t}) * P^{-1} 을 계산하면 다음과 같은 닫힌형을 얻습니다.

Phi(t) =

phi11(t) = 3 e^{-2 t} - 3 e^{-4 t} + e^{-6 t}

phi12(t) = (5/4) e^{-2 t} - 2 e^{-4 t} + (3/4) e^{-6 t}

phi13(t) = (1/8) e^{-2 t} - (1/4) e^{-4 t} + (1/8) e^{-6 t}

phi21(t) = -6 e^{-2 t} + 12 e^{-4 t} - 6 e^{-6 t}

phi22(t) = (-5/2) e^{-2 t} + 8 e^{-4 t} - (9/2) e^{-6 t}

phi23(t) = -(1/4) e^{-2 t} + e^{-4 t} - (3/4) e^{-6 t}

phi31(t) = 12 e^{-2 t} - 48 e^{-4 t} + 36 e^{-6 t}

phi32(t) = 5 e^{-2 t} - 32 e^{-4 t} + 27 e^{-6 t}

phi33(t) = (1/2) e^{-2 t} - 4 e^{-4 t} + (9/2) e^{-6 t}

정리하여 행렬로 쓰면:

Phi(t) =
[  3 e^{-2t} - 3 e^{-4t} + e^{-6t},   (5/4)e^{-2t} - 2 e^{-4t} + (3/4)e^{-6t},   (1/8)e^{-2t} - (1/4)e^{-4t} + (1/8)e^{-6t} ;
  -6 e^{-2t} +12 e^{-4t} -6 e^{-6t},   (-5/2)e^{-2t} +8 e^{-4t} - (9/2)e^{-6t},   -(1/4)e^{-2t} + e^{-4t} - (3/4)e^{-6t} ;
  12 e^{-2t} -48 e^{-4t} +36 e^{-6t},   5 e^{-2t} -32 e^{-4t} +27 e^{-6t},          (1/2)e^{-2t} -4 e^{-4t} + (9/2)e^{-6t} ]

간단 해석
- 모든 고유값 λ = -2, -4, -6 는 음수이므로 상태 행렬 A는 안정(엄밀히 말하면 점근안정)이다.
- Phi(t)은 t -> infinity 일 때 0 행렬로 수렴한다.
- 초기 상태 x(0)에 대해 x(t) = Phi(t) x(0) 으로 주어지며, 각 원소는 세 개의 감쇠 지수의 선형 결합으로 표현된다.

---

## 문제 p3.17: 상태 공간 모델로부터 전달 함수 구하기
주어진 상태 공간 모델로부터 전달 함수 G(s)를 구합니다.

```matlab
% 문제 p3.17: 상태 공간 모델로부터 전달 함수 구하기
disp('==================== 문제 p3.17 ====================');
disp('주어진 상태 공간 모델로부터 전달 함수 G(s)를 구합니다.');
A = [1 1 -1; 4 3 0; -2 1 10];
B = [0; 0; 4];
C = [1 10 0];
D = 0;
[num, den] = ss2tf(A, B, C, D);
TF_p3_17 = tf(num, den);
fprintf('\n전달 함수 G(s) = Y(s)/U(s)는 다음과 같습니다:\n');
TF_p3_17
```

출력
```text
==================== 문제 p3.17 ====================
주어진 상태 공간 모델로부터 전달 함수 G(s)를 구합니다.

G(s) = (-4 s - 148) / ( s^3 - 14 s^2 + 37 s + 20 )

% MATLAB/Octave 형태로 출력될 때:
TF_p3_17 =
 
      -4 s - 148
  -------------------------
   s^3 - 14 s^2 + 37 s + 20
```

간단 해석
- 분모 다항식은 s^3 - 14 s^2 + 37 s + 20. 이 다항식의 계수들로 볼 때 모든 계수가 양수가 아니므로(두번째 계수 -14는 음수) 안정이라고 단정할 수 없음.
- 수치 근사로 보면 이 다항식은 양의 실근 하나(약 10.2 근처)를 가지므로 열린 고리/이 시스템은 불안정(양의 극 포함).
- 따라서 이 상태 공간 모델에서 전달함수는 불안정한 거동을 보이는 것으로 판단된다.

---
