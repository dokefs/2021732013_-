```
%% ========================================================================
%  문제 p3.1: 스프링-질량-댐퍼 시스템의 상태 공간 모델
% =========================================================================
disp('==================== 문제 p3.1 ====================');
disp('스프링-질량-댐퍼 시스템의 상태 공간 모델을 구합니다.');
syms M b k
disp('(a) 상태 변수를 x1 = y(위치), x2 = y_dot(속도) 로 정의합니다.');
A = [0 1; -k/M -b/M];
B = [0; 1/M];
C = [1 0];
D = 0;
disp('(b), (c) 상태 공간 행렬 A, B, C, D 는 다음과 같습니다:');
fprintf('\nA 행렬 (Symbolic):\n'); pretty(A);
fprintf('\nB 행렬 (Symbolic):\n'); pretty(B);
fprintf('\nC 행렬 (Numeric):\n'); disp(C);
fprintf('\nD 행렬 (Numeric):\n'); disp(D);
%% ========================================================================
%  문제 p3.3: RLC 회로의 상태 공간 모델
% =========================================================================
disp('==================== 문제 p3.3 ====================');
disp('RLC 회로의 상태 미분 방정식을 구합니다.');
syms L C R
disp('상태 변수: x1 = iL (인덕터 전류), x2 = vC (커패시터 전압)');
A_p3_3 = [0, -1/L; 1/C, -1/(R*C)];
B_p3_3 = [1/L, -1/L; 0, 0];

disp('상태 공간 행렬 A, B 는 다음과 같습니다:');
fprintf('\nA 행렬:\n'); pretty(A_p3_3);
fprintf('\nB 행렬 (입력 u=[v1; v2]):\n'); pretty(B_p3_3);
%% ========================================================================
%  문제 p3.5
% =========================================================================
disp('==================== 문제 p3.5 ====================');
disp('주어진 전달 함수로부터 상태 공간 모델과 상태 천이 행렬을 구합니다.');
s = tf('s');
T = feedback((s+2)/((s+8)*(s-3)), 1); % G/(1+G*H)
% 2. 전달 함수 계수를 이용해 Phase Variable Form 행렬 바로 생성
den = T.Denominator{1}; % 분모 계수: [1 6 -22]
num = T.Numerator{1};   % 분자 계수: [1 2]

A = [0 1; -den(3) -den(2)];  % A = [0 1; -a0 -a1]
B = [0; 1];
C = [num(2) num(1)];        % C = [b0 b1]
D = 0;

% 3. 결과 출력
disp('Phase Variable Form 상태 공간 모델:');
fprintf('\nA 행렬:\n'); disp(A);
fprintf('B 행렬:\n'); disp(B);
fprintf('C 행렬:\n'); disp(C);
fprintf('D 행렬:\n'); disp(D);
%% ========================================================================
%  문제 p3.12: 전달 함수로부터 상태 공간 모델과 상태 천이 행렬 구하기
% =========================================================================
disp('==================== 문제 p3.12 ====================');
disp('주어진 전달 함수로부터 상태 공간 모델과 상태 천이 행렬을 구합니다.');
num = [0 0 8 40];
den = [1 12 44 48];
[A, B, C, D] = tf2ss(num, den);
disp('(a) 상태 공간 모델(Controllable Canonical Form)은 다음과 같습니다:');
fprintf('\nA 행렬:\n'); disp(A);
fprintf('B 행렬:\n'); disp(B);
fprintf('C 행렬:\n'); disp(C);
fprintf('D 행렬:\n'); disp(D);
syms s t
I = eye(size(A));
Phi_s = inv(s*I - A);
Phi_t = ilaplace(Phi_s, t);
fprintf('\n(b) 상태 천이 행렬 Phi(t)는 다음과 같습니다:\n');
pretty(Phi_t);
%% ========================================================================
%  문제 p3.17: 상태 공간 모델로부터 전달 함수 구하기
% =========================================================================
disp('==================== 문제 p3.17 ====================');
disp('주어진 상태 공간 모델로부터 전달 함수 G(s)를 구합니다.');
A = [1 1 -1; 4 3 0; -2 1 10];
B = [0; 0; 4];
C = [1 10 0];
D = 0;
[num, den] = ss2tf(A, B, C, D);
TF_p3_17 = tf(num, den);
fprintf('\n전달 함수 G(s) = Y(s)/U(s)는 다음과 같습니다:\n');
TF_p3_17
```